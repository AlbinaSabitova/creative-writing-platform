<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>–ü–æ–∏—Å–∫</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap&subset=cyrillic" rel="stylesheet">
    <link th:href="@{/styles.css(v=1.0)}" rel="stylesheet">
</head>
<body>
<a href="/">–ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
<!--<div th:replace="~{fragments/messages :: messages}"></div>-->
<main class="container">
    <form th:action="@{/search}" method="get" class="search-form">
        <div class="form-group">
            <input type="text" name="query" th:value="${query}"
                   placeholder="–ê–≤—Ç–æ—Ä, —Å–ª–æ–≤–æ –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏, —Ç–µ–º–∞—Ç–∏–∫–∞" class="search-input">
            <button type="submit" class="btn">üîç</button>
        </div>
    </form>

    <div th:if="${query != null and !query.isEmpty()}">
        <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –ø–æ –∑–∞–ø—Ä–æ—Å—É "<span th:text="${query}"></span>"</h2>

        <div th:if="${results.empty}">
            <p>–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>
        </div>

        <div th:each="text : ${results}" class="text-card">
            <h3><a th:href="@{/text/view/{id}(id=${text.id})}" th:text="${text.title}"></a></h3>
            <p class="meta">
                By <span th:text="${text.author.fullName}"></span> |
                <span th:text="${#temporals.format(text.publicationDate, 'dd MMM yyyy')}"></span> |
                <span th:text="${text.likes}"></span> likes
            </p>

            <div class="content-preview" th:text="${#strings.abbreviate(text.content, 200)}"></div>

            <div class="topics">
                    <span th:each="topic : ${text.topics}" class="topic"
                          th:text="${topic.name}"></span>
            </div>
        </div>
    </div>

    <div th:replace="~{fragments/pagination :: pagination(
    currentPage=${currentPage},
    totalPages=${totalPages},
    baseUrl=${'/search?query=' + query}
)}"></div>
</main>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>